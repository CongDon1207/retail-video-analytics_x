{
  "uid": "rva_people_overview",
  "title": "RVA - People Overview",
  "description": "T·ªïng quan l∆∞u l∆∞·ª£ng ng∆∞·ªùi theo camera - Real-time monitoring",
  "editable": true,
  "schemaVersion": 38,
  "version": 5,
  "time": { "from": "now-6h", "to": "now" },
  "refresh": "30s",
  "templating": { "list": [] },
  "panels": [
    {
      "id": 1,
      "type": "stat",
      "title": "T·ªïng Detections",
      "description": "T·ªïng s·ªë l·∫ßn ph√°t hi·ªán ng∆∞·ªùi trong to√†n b·ªô d·ªØ li·ªáu",
      "datasource": "Trino Lakehouse",
      "gridPos": { "h": 5, "w": 6, "x": 0, "y": 0 },
      "fieldConfig": {
        "defaults": {
          "color": { "mode": "thresholds" },
          "thresholds": { "steps": [{"color": "green", "value": null}, {"color": "yellow", "value": 5000}, {"color": "red", "value": 10000}] },
          "unit": "short"
        }
      },
      "options": { "colorMode": "value", "graphMode": "area", "justifyMode": "auto", "textMode": "auto" },
      "targets": [{ "refId": "A", "rawSql": "SELECT COALESCE(SUM(detections),0) AS value FROM lakehouse.rva.gold_people_per_minute" }]
    },
    {
      "id": 2,
      "type": "stat",
      "title": "Unique Tracks",
      "description": "S·ªë ng∆∞·ªùi ri√™ng bi·ªát (track_id unique)",
      "datasource": "Trino Lakehouse",
      "gridPos": { "h": 5, "w": 6, "x": 6, "y": 0 },
      "fieldConfig": {
        "defaults": {
          "color": { "mode": "thresholds" },
          "thresholds": { "steps": [{"color": "blue", "value": null}, {"color": "green", "value": 20}, {"color": "yellow", "value": 50}] },
          "unit": "short"
        }
      },
      "options": { "colorMode": "value", "graphMode": "area", "justifyMode": "auto", "textMode": "auto" },
      "targets": [{ "refId": "A", "rawSql": "SELECT COALESCE(SUM(unique_people),0) AS value FROM lakehouse.rva.gold_people_per_minute" }]
    },
    {
      "id": 3,
      "type": "stat",
      "title": "Cameras Ho·∫°t ƒë·ªông",
      "description": "S·ªë camera c√≥ d·ªØ li·ªáu",
      "datasource": "Trino Lakehouse",
      "gridPos": { "h": 5, "w": 6, "x": 12, "y": 0 },
      "fieldConfig": { "defaults": { "color": { "mode": "thresholds" }, "thresholds": { "steps": [{"color": "purple", "value": null}] } } },
      "targets": [{ "refId": "A", "rawSql": "SELECT COUNT(DISTINCT camera_id) AS value FROM lakehouse.rva.gold_people_per_minute" }]
    },
    {
      "id": 4,
      "type": "stat",
      "title": "Avg Detections/Min",
      "description": "Trung b√¨nh s·ªë detection m·ªói ph√∫t",
      "datasource": "Trino Lakehouse",
      "gridPos": { "h": 5, "w": 6, "x": 18, "y": 0 },
      "fieldConfig": { "defaults": { "color": { "mode": "thresholds" }, "thresholds": { "steps": [{"color": "orange", "value": null}] }, "decimals": 0 } },
      "targets": [{ "refId": "A", "rawSql": "SELECT COALESCE(AVG(detections),0) AS value FROM lakehouse.rva.gold_people_per_minute" }]
    },
    {
      "id": 5,
      "type": "timeseries",
      "title": "üìà L∆∞u l∆∞·ª£ng ng∆∞·ªùi theo th·ªùi gian",
      "description": "Bi·ªÉu ƒë·ªì trend s·ªë l∆∞·ª£ng detection theo ph√∫t, grouped by camera",
      "datasource": "Trino Lakehouse",
      "gridPos": { "h": 9, "w": 16, "x": 0, "y": 5 },
      "fieldConfig": { "defaults": { "color": { "mode": "palette-classic" }, "custom": { "fillOpacity": 20, "lineWidth": 2, "pointSize": 5, "showPoints": "auto" } } },
      "options": { "legend": { "displayMode": "list", "placement": "bottom" }, "tooltip": { "mode": "multi", "sort": "desc" } },
      "targets": [{ "refId": "A", "rawSql": "SELECT ts_minute AS time, camera_id AS metric, detections AS value\nFROM lakehouse.rva.gold_people_per_minute\nORDER BY ts_minute ASC" }]
    },
    {
      "id": 6,
      "type": "piechart",
      "title": "ü•ß Ph√¢n b·ªï theo Camera",
      "description": "T·ª∑ l·ªá detection theo t·ª´ng camera",
      "datasource": "Trino Lakehouse",
      "gridPos": { "h": 9, "w": 8, "x": 16, "y": 5 },
      "fieldConfig": { "defaults": { "color": { "mode": "palette-classic" } } },
      "options": { "legend": { "displayMode": "table", "placement": "right", "values": ["value", "percent"] }, "pieType": "donut", "tooltip": { "mode": "single" } },
      "targets": [{ "refId": "A", "rawSql": "SELECT camera_id AS metric, SUM(detections) AS value\nFROM lakehouse.rva.gold_people_per_minute\nGROUP BY camera_id\nORDER BY value DESC" }]
    },
    {
      "id": 7,
      "type": "table",
      "title": "üìã Chi ti·∫øt theo ph√∫t (m·ªõi nh·∫•t tr∆∞·ªõc)",
      "description": "B·∫£ng raw data - sort theo time ascending ƒë·ªÉ Trino plugin x·ª≠ l√Ω ƒë∆∞·ª£c",
      "datasource": "Trino Lakehouse",
      "gridPos": { "h": 8, "w": 24, "x": 0, "y": 14 },
      "fieldConfig": {
        "overrides": [
          { "matcher": { "id": "byName", "options": "detections" }, "properties": [{ "id": "custom.cellOptions", "value": { "type": "color-background", "mode": "gradient" } }] },
          { "matcher": { "id": "byName", "options": "unique_people" }, "properties": [{ "id": "custom.cellOptions", "value": { "type": "color-background", "mode": "gradient" } }] }
        ]
      },
      "options": { "showHeader": true, "footer": { "show": true, "reducer": ["sum"] }, "sortBy": [{ "displayName": "ts_minute", "desc": true }] },
      "targets": [{ "refId": "A", "rawSql": "SELECT ts_minute, store_id, camera_id, detections, unique_people\nFROM lakehouse.rva.gold_people_per_minute\nORDER BY ts_minute ASC\nLIMIT 100" }]
    }
  ]
}
