{
  "uid": "rva_track_summary",
  "title": "RVA - Track Behavior Analysis",
  "description": "Ph√¢n t√≠ch h√†nh vi di chuy·ªÉn theo track - T·ªëc ƒë·ªô, qu√£ng ƒë∆∞·ªùng, th·ªùi gian",
  "editable": true,
  "schemaVersion": 38,
  "version": 5,
  "time": { "from": "now-6h", "to": "now" },
  "refresh": "30s",
  "templating": { "list": [] },
  "panels": [
    {
      "id": 1,
      "type": "stat",
      "title": "Total Tracks",
      "description": "T·ªïng s·ªë track (ng∆∞·ªùi) ƒë∆∞·ª£c theo d√µi",
      "datasource": "Trino Lakehouse",
      "gridPos": { "h": 5, "w": 6, "x": 0, "y": 0 },
      "fieldConfig": { "defaults": { "color": { "mode": "thresholds" }, "thresholds": { "steps": [{"color": "green", "value": null}] } } },
      "targets": [{ "refId": "A", "rawSql": "SELECT COUNT(*) AS value FROM lakehouse.rva.gold_track_summary" }]
    },
    {
      "id": 2,
      "type": "stat",
      "title": "Avg Track Duration",
      "description": "Th·ªùi gian di chuy·ªÉn trung b√¨nh m·ªói track",
      "datasource": "Trino Lakehouse",
      "gridPos": { "h": 5, "w": 6, "x": 6, "y": 0 },
      "fieldConfig": { "defaults": { "color": { "mode": "thresholds" }, "thresholds": { "steps": [{"color": "blue", "value": null}, {"color": "yellow", "value": 30}, {"color": "orange", "value": 60}] }, "unit": "s", "decimals": 1 } },
      "targets": [{ "refId": "A", "rawSql": "SELECT COALESCE(AVG(duration_seconds),0) AS value FROM lakehouse.rva.gold_track_summary" }]
    },
    {
      "id": 3,
      "type": "stat",
      "title": "Avg Confidence",
      "description": "ƒê·ªô tin c·∫≠y trung b√¨nh c·ªßa detection",
      "datasource": "Trino Lakehouse",
      "gridPos": { "h": 5, "w": 6, "x": 12, "y": 0 },
      "fieldConfig": { "defaults": { "color": { "mode": "thresholds" }, "thresholds": { "steps": [{"color": "red", "value": null}, {"color": "yellow", "value": 0.6}, {"color": "green", "value": 0.8}] }, "unit": "percentunit", "decimals": 2 } },
      "targets": [{ "refId": "A", "rawSql": "SELECT COALESCE(AVG(avg_conf),0) AS value FROM lakehouse.rva.gold_track_summary" }]
    },
    {
      "id": 4,
      "type": "stat",
      "title": "Total Frames",
      "description": "T·ªïng s·ªë frames ƒë∆∞·ª£c x·ª≠ l√Ω",
      "datasource": "Trino Lakehouse",
      "gridPos": { "h": 5, "w": 6, "x": 18, "y": 0 },
      "fieldConfig": { "defaults": { "color": { "mode": "thresholds" }, "thresholds": { "steps": [{"color": "purple", "value": null}] } } },
      "targets": [{ "refId": "A", "rawSql": "SELECT COALESCE(SUM(frames),0) AS value FROM lakehouse.rva.gold_track_summary" }]
    },
    {
      "id": 5,
      "type": "timeseries",
      "title": "üìà Track Duration theo th·ªùi gian",
      "description": "Bi·ªÉu ƒë·ªì th·ªùi gian di chuy·ªÉn c·ªßa c√°c track theo timeline",
      "datasource": "Trino Lakehouse",
      "gridPos": { "h": 10, "w": 12, "x": 0, "y": 5 },
      "fieldConfig": { "defaults": { "color": { "mode": "palette-classic" }, "unit": "s" } },
      "options": { "legend": { "displayMode": "table", "placement": "bottom" }, "tooltip": { "mode": "multi" } },
      "targets": [{ "refId": "A", "rawSql": "SELECT end_time AS time, CAST(track_id AS VARCHAR) AS metric, duration_seconds AS value\nFROM lakehouse.rva.gold_track_summary\nORDER BY end_time ASC" }]
    },
    {
      "id": 6,
      "type": "bargauge",
      "title": "‚è±Ô∏è Top 15 Tracks - Duration cao nh·∫•t",
      "description": "Tracks c√≥ th·ªùi gian di chuy·ªÉn d√†i nh·∫•t",
      "datasource": "Trino Lakehouse",
      "gridPos": { "h": 10, "w": 12, "x": 12, "y": 5 },
      "fieldConfig": { "defaults": { "color": { "mode": "palette-classic" }, "unit": "s", "thresholds": { "mode": "absolute", "steps": [{"color": "green", "value": null}] } } },
      "options": { "orientation": "horizontal", "displayMode": "gradient", "showUnfilled": true, "valueMode": "color", "minVizWidth": 8, "minVizHeight": 16, "namePlacement": "auto" },
      "transformations": [{ "id": "rowsToFields", "options": { "mappings": [{ "fieldName": "track", "handlerKey": "field.name" }] } }],
      "targets": [{ "refId": "A", "rawSql": "SELECT concat('Track #', cast(track_id as varchar)) AS track, duration_seconds\nFROM lakehouse.rva.gold_track_summary\nORDER BY duration_seconds DESC\nLIMIT 15" }]
    },
    {
      "id": 7,
      "type": "bargauge",
      "title": "üéØ Top 15 Tracks - Confidence cao nh·∫•t",
      "description": "Tracks v·ªõi ƒë·ªô tin c·∫≠y detection cao nh·∫•t",
      "datasource": "Trino Lakehouse",
      "gridPos": { "h": 8, "w": 12, "x": 0, "y": 15 },
      "fieldConfig": { "defaults": { "color": { "mode": "palette-classic" }, "unit": "percentunit", "decimals": 2, "thresholds": { "mode": "absolute", "steps": [{"color": "red", "value": null}, {"color": "yellow", "value": 0.6}, {"color": "green", "value": 0.8}] } } },
      "options": { "orientation": "horizontal", "displayMode": "gradient", "showUnfilled": true, "valueMode": "color", "minVizWidth": 8, "minVizHeight": 16, "namePlacement": "auto" },
      "transformations": [{ "id": "rowsToFields", "options": { "mappings": [{ "fieldName": "track", "handlerKey": "field.name" }] } }],
      "targets": [{ "refId": "A", "rawSql": "SELECT concat('Track #', cast(track_id as varchar)) AS track, avg_conf\nFROM lakehouse.rva.gold_track_summary\nORDER BY avg_conf DESC\nLIMIT 15" }]
    },
    {
      "id": 8,
      "type": "piechart",
      "title": "ü•ß Ph√¢n b·ªë Track theo Camera",
      "description": "T·ª∑ l·ªá tracks ph√¢n b·ªë tr√™n c√°c camera",
      "datasource": "Trino Lakehouse",
      "gridPos": { "h": 8, "w": 12, "x": 12, "y": 15 },
      "fieldConfig": { "defaults": { "color": { "mode": "palette-classic" } } },
      "options": { "legend": { "displayMode": "table", "placement": "right", "values": ["value", "percent"] }, "pieType": "donut" },
      "targets": [{ "refId": "A", "rawSql": "SELECT camera_id, COUNT(*) AS tracks\nFROM lakehouse.rva.gold_track_summary\nGROUP BY camera_id\nORDER BY tracks DESC" }]
    },
    {
      "id": 9,
      "type": "table",
      "title": "üìã Track Details - Full Data",
      "description": "B·∫£ng chi ti·∫øt t·∫•t c·∫£ tracks v·ªõi metrics di chuy·ªÉn",
      "datasource": "Trino Lakehouse",
      "gridPos": { "h": 10, "w": 24, "x": 0, "y": 23 },
      "fieldConfig": {
        "overrides": [
          { "matcher": { "id": "byName", "options": "duration_seconds" }, "properties": [{ "id": "unit", "value": "s" }, { "id": "decimals", "value": 1 }] },
          { "matcher": { "id": "byName", "options": "avg_conf" }, "properties": [{ "id": "unit", "value": "percentunit" }, { "id": "decimals", "value": 2 }] },
          { "matcher": { "id": "byName", "options": "frames" }, "properties": [{ "id": "custom.cellOptions", "value": { "type": "color-background", "mode": "gradient" } }] }
        ]
      },
      "options": { "showHeader": true, "footer": { "show": true, "reducer": ["mean", "sum"] }, "sortBy": [{ "displayName": "frames", "desc": true }] },
      "targets": [{ "refId": "A", "rawSql": "SELECT store_id, camera_id, track_id, frames, duration_seconds, delta_x, delta_y, avg_conf\nFROM lakehouse.rva.gold_track_summary\nORDER BY frames ASC\nLIMIT 100" }]
    }
  ]
}
